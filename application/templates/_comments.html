<!--
<div class="comments">
    {% for comment in article.comments recursive %}
    <li class="comment">
        {% if comment.children %}
        <div class="panel panel-default">
            <div class="panel-heading">
                {{ comment.author.username }}
            </div>
            <div class="panel-body">
                {{ comment.body }}


                <div class="panel-body">
                    {% if comment.children %}
                    {{ loop(comment.children) }}
                    {% endif %}
                </div>

            </div>
            {% else %}
            <div class="panel panel-default">
                <div class="panel-heading">
                    {{ comment.author.username }}
                </div>
                <div class="panel-body">
                    {{ comment.body }}
                </div>
            </div>
            {% endif %}
            <a href="{{ url_for('main.article', id=article.id, replytoid=comment.id) + '#comment' }} ">回复</a>
        </div>
    </li>
    {% endfor %}
</div>
-->
{% macro render_comment(comment, ischild=False) %}
<ul>
    {% if not ischild %}
    <li>{{comment.author.username}}:{{comment.body}} <p><a
            href="{{ url_for('main.article', id=article.id, replytoid=comment.id) + '#comment' }} "
            title="回复该条评论">回复</a>{{' ' * 4}}
        reply date:{{ comment.reply_date.strftime('%Y/%m/%d') }}
    </p></li>
    {% else %}
    <!-- 这种写法感觉不太好，将逻辑混在视图中， 以后改进 -->
    <li>{{comment.author.username}}回复{{Comment.query.get(comment.parent_id).author.username}}:{{comment.body}} <p><a
            href="{{ url_for('main.article', id=article.id, replytoid=comment.id) + '#comment' }} "
            title="回复该条评论">回复</a>
        {{'    '}}
        reply date:{{ comment.reply_date.strftime('%Y/%m/%d') }}
    </p></li>
    {% endif %}
    <ul>
        {% for child in comment.children %}
        {{ render_comment(child, ischild=True) }}
        {% endfor %}
    </ul>
</ul>
{% endmacro %}

<div style="margin-top:50px;">
    <h3>评论列表：</h3>
    {% for comment in parent_comments %}
    <div class="comment-wrapper">
        {{ render_comment(comment) }}
    </div>
    {% endfor %}


</div>
